<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.leapframework.org/schema/beans"
       if-servlet-environment="true"
       if-class-present="leap.web.security.SecurityConfig">

    <!-- common -->
    <bean type="leap.oauth2.webapp.OAuth2ErrorHandler"
          class="leap.oauth2.webapp.DefaultOAuth2ErrorHandler" primary="true"/>

    <!-- config -->
    <bean type="leap.oauth2.webapp.OAuth2Config"
          class="leap.oauth2.webapp.DefaultOAuth2Config" primary="true">

        <additional-type-def type="leap.oauth2.webapp.OAuth2Configurator" primary="true"/>

    </bean>

    <!-- login -->
    <bean type="leap.web.security.SecurityInterceptor"
          class="leap.oauth2.webapp.login.OAuth2LoginInterceptor"/>

    <bean type="leap.oauth2.webapp.login.OAuth2LoginHandler"
          class="leap.oauth2.webapp.login.DefaultOAuth2LoginHandler" primary="true"/>

    <!-- logout -->
    <bean type="leap.web.security.SecurityInterceptor"
          class="leap.oauth2.webapp.logout.OAuth2LogoutInterceptor"/>

    <bean type="leap.oauth2.webapp.logout.OAuth2LogoutHandler"
          class="leap.oauth2.webapp.logout.DefaultOAuth2LogoutHandler" primary="true"/>

    <!-- authc -->
    <bean type="leap.web.security.SecurityInterceptor"
          class="leap.oauth2.webapp.authc.OAuth2AuthenticationInterceptor"/>

    <bean type="leap.oauth2.webapp.authc.OAuth2CredentialsAuthenticator"
          class="leap.oauth2.webapp.authc.DefaultOAuth2CredentialsAuthenticator" primary="true"/>

    <!-- token -->
    <bean type="leap.oauth2.webapp.token.TokenManager"
          class="leap.oauth2.webapp.token.DefaultTokenManager" primary="true"/>

    <bean name="bearer"
          type="leap.oauth2.webapp.token.AccessTokenExtractor"
          class="leap.oauth2.webapp.token.BearerAccessTokenExtractor" primary="true"/>

    <bean name="remote"
          type="leap.oauth2.webapp.token.BearerAccessTokenStore"
          class="leap.oauth2.webapp.token.RemoteBearerAccessTokenStore"/>

    <bean name="jwt"
          type="leap.oauth2.webapp.token.BearerAccessTokenStore"
          class="leap.oauth2.webapp.token.JwtAccessTokenStore">
    </bean>

    <!-- userinfo -->
    <bean type="leap.oauth2.webapp.user.UserInfoLookup"
          class="leap.oauth2.webapp.user.DefaultUserInfoLookup" primary="true"/>

    <!-- tokeninfo -->
    <bean type="leap.oauth2.webapp.token.TokenInfoLookup"
          class="leap.oauth2.webapp.token.DefaultTokenInfoLookup" primary="true"/>

    <!-- old wac -->
    <bean type="leap.oauth2.wac.OAuth2WebAppConfig"
          class="leap.oauth2.wac.DefaultOAuth2WebAppConfig" primary="true">

        <additional-type-def type="leap.oauth2.wac.OAuth2WebAppConfigurator" primary="true"/>

    </bean>

    <bean type="leap.oauth2.wac.token.WacTokenManager"
          class="leap.oauth2.wac.token.DefaultWacTokenManager" primary="true"/>

    <bean type="leap.oauth2.wac.auth.WacResponseHandler"
          class="leap.oauth2.wac.auth.DefaultWacResponseHandler" primary="true"/>

    <bean name="jdbc"
          type="leap.oauth2.wac.token.WacTokenStore"
          class="leap.oauth2.wac.token.JdbcWacTokenStore"/>

    <bean type="leap.web.security.SecurityInterceptor" class="leap.oauth2.wac.OAuth2WebAppSecurityInterceptor"/>

</beans>